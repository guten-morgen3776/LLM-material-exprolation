# 「LLMは化学者になれるか？　ーSMILES生成による薬らしい分子設計とデータベースに基づく妥当性検証ー」
## 1.設計の狙い</br>
　本研究は、生成AIを利用した物理的な「デザイン」や「ものづくり」の可能性と限界を論じるという課題に対し、医薬品開発、すなわち創薬のプロセスを「物理的な分子製品の設計」として捉え直す試みである。医薬品開発は、その初期段階において、莫大な数の候補が存在する化学空間から有効な「リード化合物」を探索するプロセスが最大のボトルネックとなっている。本研究では、この探索プロセスをAIによる設計タスクとして定義する。</br>
　ここで設計図として用いるのは、コンピュータが処理可能な一次元の分子表列表現であるSMILES記法である。。したがって、AIによる「ものづくり」とは、AIが特定の制約を満たす新規のSMILES文字列を生成することと位置づける。</br>
　この設計の成功を判定するため、三つの厳格な仕様を定義した。第一の仕様は「妥当性」であり、生成されたSMILESが化学的に妥当な構造として解釈可能であることを求める。第二の仕様は「有用性」であり、医薬品候補の経験則であるリピンスキーの法則、例えば分子量五百以下やlogP5以下といった複数の物理化学的特性をすべて満たすことを要求する。第三の仕様は「新規性」であり、既存の医薬品と重複しない、構造的な新しさを求める。この新規性の検証は、PubChemから抽出した17932件の薬剤データベースと構造類似度を比較することで客観的に行った。</br>

## 2.設計の方法
設計AI、すなわちジェネレーターとしては、高性能な大規模言語モデルであるgemini2.5 pro を採用した。AIに対する設計指示は、プロンプトエンジニアリングの手法を用いて行った。具体的には、AIに対して熟練の化学者としての役割を与え、前節で定義した三つの設計仕様、すなわちリピンスキーの法則の遵守と高い新規性を、明確な制約条件としてテキストで指示した。この指示に基づき、AIには二十個の新規SMILES文字列を生成させた。</br>
　次に、生成された二十個のSMILESを検証するため、Google Colab環境上で化学情報ライブラリRDKitを用いた自動評価パイプラインを構築した。このパイプラインは、三段階の検証プロセスを実行する。</br>
　第一の検証は「妥当性検証」であり、Chem.MolFromSmiles関数が分子オブジェクトを返さずNoneを返した場合、すなわちSMILESを構造としてパースできなかったものを、第一の失敗類型である「構文エラー」として分類した。</br>
　第二の検証は「有用性検証」であり、妥当と判定された分子に対し、RDKitのDescriptorモジュールを用いてリピンスキーの法則に関わる各物理化学的特性を計算した。一つでも制約を満たさないものを、第二の失敗類型である「仕様違反」とした。</br>
　第三の検証は「新規性検証」であり、前節で述べた17932件のPubChem薬剤データベースの全分子指紋と、生成分子の指紋との間でTanimoto係数による構造類似度を一括計算した。ここで、最も類似度の高い分子との係数が閾値の0.85以上であった場合、既存薬の模倣であるとみなし、第三の失敗類型である「新規性なし」と判定した。</br>
　これら３つの失敗型のいずれにも該当しなかったSMILESのみを最終的な設計成功として定義した。

## 3.結果
| タイプ | 該当件数 |
| :--- | :---: |
| False(構文エラー) | 3 |
| False(仕様違反) | 0 |
| False(新規性なし) | 0 |
| Success | 17 | 

20件のSMILES文字列を設計させた結果、自動評価パイプラインは非常に明瞭な結果を示した。最終的に「設計成功」と判定された分子は17件に達し、成功率は85%という高い値を示した。驚くべきことに、失敗の内訳はすべて第一の失敗類型である「構文エラー」が3件であった。第二の失敗類型である「仕様違反」、すなわちリピンスキーの法則を逸脱した分子は一件も生成されなかった。さらに、第三の失敗類型である「新規性なし」、すなわち既存薬データベースと構造的に酷似した分子は一件も生成されなかった。</br>
　「設計成功」と判定された17件の分子は、いずれも有用性の基準をすべて満たし、かつ既存薬データベースとの最大類似度も低い値に抑えられており、LLMが有用かつ新規な分子構造の設計図を高い精度で生成できることを示している。</br>
成功例(SMILESを構造式に変換したもの)　</br>
 <img width="1800" height="900" alt="Unknown-3" src="https://github.com/user-attachments/assets/5c329892-028f-4aa4-b1f9-e2cb7ee2cb78" />
一方、「設計失敗」となった3件のSMILESを詳細に分析したところ、一つは明らかな設計ミス、残りの２つは「ケクレ化エラー」であることが判明した。ケクレ化とは、芳香環のSMILES表記を解釈する際に、原子価のルールを守りながら単結合と二重結合を交互に割り当てるプロセスである。AIが生成したSMILESは、一見すると芳香環を形成しているように見えたが、その構造が物理法則に反していたため、RDKitは二重結合を正しく割り当てることができず、これを無効な構造として棄却した。</br>
１つ目</br>
 ![IMG_0485](https://github.com/user-attachments/assets/b4ffabcc-6f53-4508-bd70-dd5f778f669a)
明らかにSMILES表記の規則に則ってない箇所があるのに加えて、Nから手が４本出るなど現実に存在できない分子である。</br>

2,3つ目</br>
 ![IMG_0486-2](https://github.com/user-attachments/assets/78cc2258-b983-4d77-a1db-5d1687012833)
これらについてはSMILES表記を化学的知識をもとに解釈すれば正しい構造が得られるが、コンピューター上では正しく処理することができなくなっている。

## 4.考察
今回の実験結果はLLMによる分子設計の可能性と、同時にその本質的な限界の両方を鮮明に浮き彫りにした。
　可能性として特筆すべきは85%という高い成功率と、失敗の内訳である。リピンスキー違反と新規性違反がゼロであったという事実は、LLMが分子量500以下といった具体的な物理化学的制約や、既存の化合物と一致してはいけないという極めて抽象的かつ広範な制約を、プロンプトの指示のみで正確に理解し、実行できたことを意味する。これはAIが、広大な化学空間の中から「薬らしい」という狭い領域のみを効率的に探索し、かつ既知の答えを回避する優れたナビゲーターとして機能することを示している。</br>
　一方で、失敗した3件が存在し得ない化合物、またはケクレ化エラーであった事実は、AI設計の根本的な限界を露呈している。これは、LLMがSMILESという言語の表面的な文法、例えば括弧や数字を正しく閉じるといったことは学習できている一方で、その表記の解釈性やその背景にある物理法則、すなわち芳香族性の電子配置や原子価の厳密なルールを真に理解しているわけではないことを示している。結果として、AIのハルシネーションが化学の文脈で現れ、言語的にはもっともらしいが物理的に存在不可能な分子を設計してしまった。</br>
　さらに、今回の「設計成功」が意味する限界も指摘せねばならない。第一に、この設計図が製造可能かどうか、すなわち現在の化学技術で合成できるかという、ものづくりにおける最大の物理的制約は一切考慮されていない。第二に、SMILESは一次元ないし二次元の設計図に過ぎず、薬の機能にとって最も重要な三次元立体構造が、標的タンパク質の鍵穴に適合するかどうかは全く保証されていない。</br>
　結論として、LLMは制約下でアイデアを高速に探索する超人的な助手として、創薬デザインの初期段階を劇的に加速させる可能性を秘めている。しかし、AIが生成した設計図の妥当性を、物理法則に基づき厳格に検証し、その中から真の価値を引き出すためには、RDKitのような専門的な検証ツールと、そして何より「製造」や「立体構造」の文脈を理解する人間、すなわち化学者やデザイナーの深い専門知識が今後ますます重要になるであろう。
